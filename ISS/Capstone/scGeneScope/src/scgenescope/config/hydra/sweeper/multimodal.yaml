# @package hydra.sweeper
_target_: hydra_plugins.hydra_optuna_sweeper.optuna_sweeper.OptunaSweeper

direction: maximize
study_name: null
storage: null
n_trials: 30
n_jobs: 1

sampler:
  _target_: optuna.samplers.TPESampler
  seed: 1

params:
  # -------------------------
  # Joint classifier (Table 4)
  # -------------------------
  "model.classifier.hidden_dim": choice(256,384,512,768,1024,1536,2048,3072,4096)

  # depth: Int 1..7, step=2  => {1,3,5,7}
  "model.classifier.depth": choice(1,3,5,7)

  # lr: Float 1e-5..1e-3 log=True (log-spaced candidates)
  "model.optimizer_factory.lr": choice(1e-5,2e-5,3e-5,5e-5,1e-4,2e-4,3e-4,5e-4,1e-3)

  # weight_decay: Float 1e-6..1e-2 log=True (log-spaced candidates)
  "model.optimizer_factory.weight_decay": choice(1e-6,2e-6,3e-6,5e-6,1e-5,2e-5,3e-5,5e-5,1e-4,2e-4,3e-4,5e-4,1e-3,2e-3,3e-3,5e-3,1e-2)

  # hidden_dropout: Categorical [0, 0.25, 0.5]
  "model.hidden_dropout": choice(0.0,0.25,0.5)

  # -------------------------
  # RNA encoder (Table 4)
  # -------------------------
  "model.rnaseq.hidden_dim": choice(256,384,512,768,1024,1536,2048,3072,4096)

  # rnaseq depth: Int 1..7 step=2 => {1,3,5,7}
  "model.rnaseq.depth": choice(1,3,5,7)

  # input_dropout.rnaseq: Categorical [0, 0.25, 0.5]
  "model.input_dropout.rnaseq": choice(0.0,0.25,0.5)

  # -------------------------
  # Imaging encoder (Table 4)
  # -------------------------
  "model.imaging.hidden_dim": choice(256,384,512,768,1024,1536,2048,3072,4096)

  # imaging depth: Int 1..7 step=2 => {1,3,5,7}
  "model.imaging.depth": choice(1,3,5,7)

  # input_dropout.imaging: Categorical [0, 0.25, 0.5]
  "model.input_dropout.imaging": choice(0.0,0.25,0.5)

  # -------------------------
  # Output dimension per modality (Table 4)
  # -------------------------
  "OUTPUT_DIM_PER_MODALITY": choice(256,384,512,768,1024,1536,2048,3072,4096)

search_space: null
custom_search_space: null